import{s as p,r as g,j as r,z as b,u as K}from"./index-Dmi3SrJi.js";class R{constructor(e,s,t,a,i,l,n,c,u,k,h,y,d=[],x=[],f={},_,v,N=[],S=new Date,D=new Date){this.id=e,this.tenant_id=s,this.name=t,this.description=a,this.short_description=i,this.sku=l,this.status=n,this.product_type=c,this.categories=u,this.tags=k,this.weight=h,this.dimensions=y,this.variants=d,this.images=x,this.metadata=f,this.seo_title=_,this.seo_description=v,this.seo_keywords=N,this.created_at=S,this.updated_at=D,this.validate()}validate(){if(!this.name||this.name.trim().length===0)throw new Error("Product name is required");if(!this.sku||this.sku.trim().length===0)throw new Error("Product SKU is required");if(!this.tenant_id)throw new Error("Product must belong to a tenant");if(this.variants.length>0&&this.product_type==="simple")throw new Error("Simple products cannot have variants");if(this.variants.length===0&&this.product_type==="variable")throw new Error("Variable products must have variants");if(this.variants.filter((s,t,a)=>a.findIndex(i=>i.sku===s.sku)!==t).length>0)throw new Error("Duplicate SKUs found in variants")}updateName(e){if(!e||e.trim().length===0)throw new Error("Product name cannot be empty");this.name=e.trim(),this.updated_at=new Date}updateDescription(e,s){this.description=e,this.short_description=s,this.updated_at=new Date}addVariant(e){if(this.product_type==="simple")throw new Error("Cannot add variants to simple products");if(this.variants.find(a=>a.sku===e.sku))throw new Error(`Variant with SKU ${e.sku} already exists`);const t={...e,id:crypto.randomUUID(),product_id:this.id,created_at:new Date,updated_at:new Date};this.variants.push(t),this.updated_at=new Date}removeVariant(e){const s=this.variants.findIndex(t=>t.id===e);if(s===-1)throw new Error("Variant not found");this.variants.splice(s,1),this.updated_at=new Date}updateVariantStock(e,s){const t=this.variants.find(a=>a.id===e);if(!t)throw new Error("Variant not found");if(s<0)throw new Error("Stock quantity cannot be negative");t.stock_quantity=s,t.updated_at=new Date,this.updated_at=new Date}updateVariantPrice(e,s){const t=this.variants.find(a=>a.id===e);if(!t)throw new Error("Variant not found");if(s<0)throw new Error("Price cannot be negative");t.price=s,t.updated_at=new Date,this.updated_at=new Date}addImage(e){const s={...e,id:crypto.randomUUID(),product_id:this.id,created_at:new Date};this.images.push(s),this.updated_at=new Date}removeImage(e){const s=this.images.findIndex(t=>t.id===e);if(s===-1)throw new Error("Image not found");this.images.splice(s,1),this.updated_at=new Date}setPrimaryImage(e){this.images.forEach(t=>t.is_primary=!1);const s=this.images.find(t=>t.id===e);if(!s)throw new Error("Image not found");s.is_primary=!0,this.updated_at=new Date}updateStatus(e){this.status=e,this.updated_at=new Date}getPrimaryImageUrl(){return this.images.find(s=>s.is_primary)?.url||null}getTotalStock(){return this.product_type==="simple"?0:this.variants.reduce((e,s)=>e+s.stock_quantity,0)}getMinPrice(){return this.variants.length===0?null:Math.min(...this.variants.map(e=>e.price))}getMaxPrice(){return this.variants.length===0?null:Math.max(...this.variants.map(e=>e.price))}isInStock(){return this.getTotalStock()>0}createAuditLog(e,s,t,a,i){return{id:crypto.randomUUID(),product_id:this.id,action:e,old_values:t,new_values:a,changed_by:s,changed_at:new Date,reason:i}}toJSON(){return{id:this.id,tenant_id:this.tenant_id,name:this.name,description:this.description,short_description:this.short_description,sku:this.sku,status:this.status,product_type:this.product_type,categories:this.categories,tags:this.tags,weight:this.weight,dimensions:this.dimensions,variants:this.variants,images:this.images,metadata:this.metadata,seo_title:this.seo_title,seo_description:this.seo_description,seo_keywords:this.seo_keywords,created_at:this.created_at,updated_at:this.updated_at}}}class V{async findById(e){try{const{data:s,error:t}=await p.from("products").select(`
          *,
          product_variants (*),
          product_images (*)
        `).eq("id",e).single();if(t)throw t;return s?this.mapToEntity(s):null}catch(s){throw console.error("Find product by ID error:",s),s}}async findBySku(e,s){try{const{data:t,error:a}=await p.from("products").select(`
          *,
          product_variants (*),
          product_images (*)
        `).eq("tenant_id",e).eq("sku",s).single();if(a&&a.code!=="PGRST116")throw a;return t?this.mapToEntity(t):null}catch(t){throw console.error("Find product by SKU error:",t),t}}async findMany(e,s,t){try{let a=p.from("products").select(`
          *,
          product_variants (*),
          product_images (*)
        `,{count:"exact"});if(e.tenant_id&&(a=a.eq("tenant_id",e.tenant_id)),e.status&&(a=a.eq("status",e.status)),e.product_type&&(a=a.eq("product_type",e.product_type)),e.categories&&e.categories.length>0&&(a=a.overlaps("categories",e.categories)),e.tags&&e.tags.length>0&&(a=a.overlaps("tags",e.tags)),e.search&&(a=a.or(`name.ilike.%${e.search}%,description.ilike.%${e.search}%,sku.ilike.%${e.search}%`)),e.in_stock!==void 0&&(e.in_stock?a=a.gt("product_variants.stock_quantity",0):a=a.eq("product_variants.stock_quantity",0)),e.created_after&&(a=a.gte("created_at",e.created_after.toISOString())),e.created_before&&(a=a.lte("created_at",e.created_before.toISOString())),s?a=a.order(s.field,{ascending:s.direction==="asc"}):a=a.order("created_at",{ascending:!1}),t){const h=(t.page-1)*t.limit,y=h+t.limit-1;a=a.range(h,y)}const{data:i,error:l,count:n}=await a;if(l)throw console.error("Supabase query error:",l),console.error("Query details:",{filters:e,sort:s,pagination:t,tenant_id:e.tenant_id}),l;const c=(i||[]).map(h=>this.mapToEntity(h)),u=n||0,k=t?Math.ceil(u/t.limit):1;return{data:c,total:u,page:t?.page||1,limit:t?.limit||u,totalPages:k,hasNext:t?t.page<k:!1,hasPrev:t?t.page>1:!1}}catch(a){throw console.error("Find products error:",a),a}}async findByTenant(e,s,t){return this.findMany({tenant_id:e},s,t)}async findByCategory(e,s,t,a){return this.findMany({tenant_id:e,categories:[s]},t,a)}async search(e,s,t,a){return this.findMany({tenant_id:e,search:s},t,a)}async create(e){try{const s={id:e.id,tenant_id:e.tenant_id,name:e.name,description:e.description,short_description:e.short_description,sku:e.sku,status:e.status,product_type:e.product_type,categories:e.categories,tags:e.tags,weight:e.weight,dimensions:e.dimensions,metadata:e.metadata,seo_title:e.seo_title,seo_description:e.seo_description,seo_keywords:e.seo_keywords,created_at:e.created_at.toISOString(),updated_at:e.updated_at.toISOString()},{data:t,error:a}=await p.from("products").insert([s]).select().single();if(a)throw a;if(e.variants.length>0){const i=e.variants.map(n=>({id:n.id,product_id:n.product_id,name:n.name,sku:n.sku,price:n.price,cost:n.cost,stock_quantity:n.stock_quantity,weight:n.weight,dimensions:n.dimensions,attributes:n.attributes,is_active:n.is_active,created_at:n.created_at.toISOString(),updated_at:n.updated_at.toISOString()})),{error:l}=await p.from("product_variants").insert(i);if(l)throw l}if(e.images.length>0){const i=e.images.map(n=>({id:n.id,product_id:n.product_id,url:n.url,alt_text:n.alt_text,sort_order:n.sort_order,is_primary:n.is_primary,created_at:n.created_at.toISOString()})),{error:l}=await p.from("product_images").insert(i);if(l)throw l}return await this.findById(e.id)}catch(s){throw console.error("Create product error:",s),s}}async update(e){try{const s={name:e.name,description:e.description,short_description:e.short_description,sku:e.sku,status:e.status,product_type:e.product_type,categories:e.categories,tags:e.tags,weight:e.weight,dimensions:e.dimensions,metadata:e.metadata,seo_title:e.seo_title,seo_description:e.seo_description,seo_keywords:e.seo_keywords,updated_at:e.updated_at.toISOString()},{error:t}=await p.from("products").update(s).eq("id",e.id);if(t)throw t;return await this.findById(e.id)}catch(s){throw console.error("Update product error:",s),s}}async delete(e){try{await p.from("product_variants").delete().eq("product_id",e),await p.from("product_images").delete().eq("product_id",e);const{error:s}=await p.from("products").delete().eq("id",e);if(s)throw s}catch(s){throw console.error("Delete product error:",s),s}}async skuExists(e,s,t){try{let a=p.from("products").select("id").eq("tenant_id",e).eq("sku",s);t&&(a=a.neq("id",t));const{data:i,error:l}=await a;if(l)throw l;return(i||[]).length>0}catch(a){throw console.error("Check SKU exists error:",a),a}}async getCountByStatus(e){try{const{data:s,error:t}=await p.from("products").select("status").eq("tenant_id",e);if(t)throw t;const a={active:0,inactive:0,draft:0,archived:0};return(s||[]).forEach(i=>{a[i.status]=(a[i.status]||0)+1}),a}catch(s){throw console.error("Get count by status error:",s),s}}async getLowStockProducts(e,s){try{const{data:t,error:a}=await p.from("products").select(`
          *,
          product_variants (*),
          product_images (*)
        `).eq("tenant_id",e).lte("product_variants.stock_quantity",s);if(a)throw a;return(t||[]).map(i=>this.mapToEntity(i))}catch(t){throw console.error("Get low stock products error:",t),t}}async getProductsByDateRange(e,s,t){try{const{data:a,error:i}=await p.from("products").select(`
          *,
          product_variants (*),
          product_images (*)
        `).eq("tenant_id",e).gte("created_at",s.toISOString()).lte("created_at",t.toISOString()).order("created_at",{ascending:!1});if(i)throw i;return(a||[]).map(l=>this.mapToEntity(l))}catch(a){throw console.error("Get products by date range error:",a),a}}async bulkUpdateStatus(e,s){try{const{error:t}=await p.from("products").update({status:s,updated_at:new Date().toISOString()}).in("id",e);if(t)throw t}catch(t){throw console.error("Bulk update status error:",t),t}}async bulkDelete(e){try{await p.from("product_variants").delete().in("product_id",e),await p.from("product_images").delete().in("product_id",e);const{error:s}=await p.from("products").delete().in("id",e);if(s)throw s}catch(s){throw console.error("Bulk delete error:",s),s}}async getStatistics(e){try{const s=await this.getCountByStatus(e),t=await this.getLowStockProducts(e,10),a=await this.getLowStockProducts(e,0),{data:i,error:l}=await p.from("product_variants").select("price").eq("products.tenant_id",e);if(l)throw l;const n=(i||[]).reduce((c,u)=>c+(u.price||0),0);return{total:Object.values(s).reduce((c,u)=>c+u,0),active:s.active||0,inactive:s.inactive||0,draft:s.draft||0,archived:s.archived||0,low_stock:t.length,out_of_stock:a.length,total_value:n}}catch(s){throw console.error("Get statistics error:",s),s}}mapToEntity(e){return new R(e.id,e.tenant_id,e.name,e.description,e.short_description,e.sku,e.status,e.product_type,e.categories||[],e.tags||[],e.weight,e.dimensions,(e.product_variants||[]).map(s=>({...s,created_at:new Date(s.created_at),updated_at:new Date(s.updated_at)})),(e.product_images||[]).map(s=>({...s,created_at:new Date(s.created_at)})),e.metadata||{},e.seo_title,e.seo_description,e.seo_keywords||[],new Date(e.created_at),new Date(e.updated_at))}}class L{constructor(e){this.productRepository=e}async execute(e,s){try{await this.validateRequest(e);const t=new R(crypto.randomUUID(),e.tenant_id,e.name,e.description,e.short_description,e.sku,e.status,e.product_type,e.categories,e.tags,e.weight,e.dimensions,[],[],e.metadata||{},e.seo_title,e.seo_description,e.seo_keywords||[]);return{success:!0,product:await this.productRepository.create(t)}}catch(t){return console.error("CreateProductUseCase error:",t),{success:!1,error:t instanceof Error?t.message:"Unknown error occurred"}}}async validateRequest(e){if(await this.productRepository.skuExists(e.tenant_id,e.sku))throw new Error(`Product with SKU ${e.sku} already exists`);if(!e.name?.trim())throw new Error("Product name is required");if(!e.sku?.trim())throw new Error("Product SKU is required");if(!e.description?.trim())throw new Error("Product description is required");if(!e.short_description?.trim())throw new Error("Product short description is required");if(!/^[A-Za-z0-9-_]+$/.test(e.sku))throw new Error("SKU can only contain letters, numbers, hyphens, and underscores");if(e.dimensions){const{length:a,width:i,height:l}=e.dimensions;if(a<=0||i<=0||l<=0)throw new Error("All dimensions must be positive numbers")}if(e.weight!==void 0&&e.weight<=0)throw new Error("Weight must be a positive number")}}class ${constructor(e){this.productRepository=e}async execute(e){try{const s={tenant_id:e.tenant_id,...e.filters},t=e.pagination||{page:1,limit:20},a=e.sort||{field:"created_at",direction:"desc"};return{success:!0,products:await this.productRepository.findMany(s,a,t)}}catch(s){return console.error("GetProductsUseCase error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}}class z{constructor(e){this.productRepository=e}async execute(e,s){try{const t=await this.productRepository.findById(e.id);if(!t)throw new Error("Product not found");return await this.validateRequest(e,t),e.name!==void 0&&t.updateName(e.name),(e.description!==void 0||e.short_description!==void 0)&&t.updateDescription(e.description||t.description,e.short_description||t.short_description),e.sku!==void 0&&(t.sku=e.sku,t.updated_at=new Date),e.status!==void 0&&t.updateStatus(e.status),e.categories!==void 0&&(t.categories=e.categories,t.updated_at=new Date),e.tags!==void 0&&(t.tags=e.tags,t.updated_at=new Date),e.weight!==void 0&&(t.weight=e.weight,t.updated_at=new Date),e.dimensions!==void 0&&(t.dimensions=e.dimensions,t.updated_at=new Date),e.seo_title!==void 0&&(t.seo_title=e.seo_title,t.updated_at=new Date),e.seo_description!==void 0&&(t.seo_description=e.seo_description,t.updated_at=new Date),e.seo_keywords!==void 0&&(t.seo_keywords=e.seo_keywords,t.updated_at=new Date),e.metadata!==void 0&&(t.metadata=e.metadata,t.updated_at=new Date),{success:!0,product:await this.productRepository.update(t)}}catch(t){return console.error("UpdateProductUseCase error:",t),{success:!1,error:t instanceof Error?t.message:"Unknown error occurred"}}}async validateRequest(e,s){if(e.sku!==void 0){if(!e.sku.trim())throw new Error("Product SKU is required");if(await this.productRepository.skuExists(s.tenant_id,e.sku,s.id))throw new Error(`Product with SKU ${e.sku} already exists`);if(!/^[A-Za-z0-9-_]+$/.test(e.sku))throw new Error("SKU can only contain letters, numbers, hyphens, and underscores")}if(e.name!==void 0&&!e.name.trim())throw new Error("Product name cannot be empty");if(e.description!==void 0&&!e.description.trim())throw new Error("Product description cannot be empty");if(e.short_description!==void 0&&!e.short_description.trim())throw new Error("Product short description cannot be empty");if(e.dimensions){const{length:t,width:a,height:i}=e.dimensions;if(t<=0||a<=0||i<=0)throw new Error("All dimensions must be positive numbers")}if(e.weight!==void 0&&e.weight<=0)throw new Error("Weight must be a positive number")}}class F{constructor(e){this.productRepository=e}async execute(e,s){try{const t=await this.productRepository.findById(e.id);if(!t)throw new Error("Product not found");return await this.validateDeletion(t,e.force),await this.productRepository.delete(e.id),{success:!0}}catch(t){return console.error("DeleteProductUseCase error:",t),{success:!1,error:t instanceof Error?t.message:"Unknown error occurred"}}}async validateDeletion(e,s){e.status==="active"&&!s&&console.warn(`Deleting active product ${e.id} without force flag`)}}class H{productRepository;createProductUseCase;getProductsUseCase;updateProductUseCase;deleteProductUseCase;constructor(){this.productRepository=new V,this.createProductUseCase=new L(this.productRepository),this.getProductsUseCase=new $(this.productRepository),this.updateProductUseCase=new z(this.productRepository),this.deleteProductUseCase=new F(this.productRepository)}async createProduct(e,s){return await this.createProductUseCase.execute(e,s)}async getProducts(e){return e.tenant_id==="all"?await this.getAllProducts(e):await this.getProductsUseCase.execute(e)}async getAllProducts(e){try{const s={...e.filters},t=e.pagination||{page:1,limit:20},a=e.sort||{field:"created_at",direction:"desc"};return{success:!0,products:await this.productRepository.findMany(s,a,t)}}catch(s){return console.error("Get all products error:",s),{success:!1,error:s instanceof Error?s.message:"Unknown error occurred"}}}async getProductById(e){try{return await this.productRepository.findById(e)}catch(s){throw console.error("Get product by ID error:",s),s}}async updateProduct(e,s){return await this.updateProductUseCase.execute(e,s)}async deleteProduct(e,s){return await this.deleteProductUseCase.execute(e,s)}async searchProducts(e,s,t,a){try{return await this.productRepository.search(e,s,t,a)}catch(i){throw console.error("Search products error:",i),i}}async getProductsByCategory(e,s,t,a){try{return await this.productRepository.findByCategory(e,s,t,a)}catch(i){throw console.error("Get products by category error:",i),i}}async getLowStockProducts(e,s=10){try{return await this.productRepository.getLowStockProducts(e,s)}catch(t){throw console.error("Get low stock products error:",t),t}}async bulkUpdateStatus(e,s){try{return await this.productRepository.bulkUpdateStatus(e,s)}catch(t){throw console.error("Bulk update status error:",t),t}}async bulkDeleteProducts(e){try{return await this.productRepository.bulkDelete(e)}catch(s){throw console.error("Bulk delete products error:",s),s}}async getProductStatistics(e){try{return await this.productRepository.getStatistics(e)}catch(s){throw console.error("Get product statistics error:",s),s}}async checkSkuExists(e,s,t){try{return await this.productRepository.skuExists(e,s,t)}catch(a){throw console.error("Check SKU exists error:",a),a}}async getProductsByDateRange(e,s,t){try{return await this.productRepository.getProductsByDateRange(e,s,t)}catch(a){throw console.error("Get products by date range error:",a),a}}}const j=new H;function Y({isOpen:m,onClose:e,onSuccess:s,editingProduct:t,tenantId:a}){const[i,l]=g.useState(!1),n="00000000-0000-0000-0000-000000000001",[c,u]=g.useState({tenant_id:a||n,name:"",description:"",short_description:"",sku:"",status:"draft",product_type:"simple",categories:[],tags:[],weight:void 0,dimensions:void 0,seo_title:"",seo_description:"",seo_keywords:[],metadata:{}});g.useEffect(()=>{m&&u(t?{tenant_id:t.tenant_id,name:t.name,description:t.description,short_description:t.short_description,sku:t.sku,status:t.status,product_type:t.product_type,categories:t.categories,tags:t.tags,weight:t.weight,dimensions:t.dimensions,seo_title:t.seo_title||"",seo_description:t.seo_description||"",seo_keywords:t.seo_keywords,metadata:t.metadata}:{tenant_id:a||n,name:"",description:"",short_description:"",sku:"",status:"draft",product_type:"simple",categories:[],tags:[],weight:void 0,dimensions:void 0,seo_title:"",seo_description:"",seo_keywords:[],metadata:{}})},[m,t,a]);const k=async d=>{d.preventDefault(),l(!0),console.log("Form submit başladı:",{formData:c,tenantId:a,editingProduct:!!t,authToken:localStorage.getItem("supabase.auth.token")});try{if(t){const x={id:t.id,name:c.name,description:c.description,short_description:c.short_description,sku:c.sku,status:c.status,categories:c.categories,tags:c.tags,weight:c.weight,dimensions:c.dimensions,seo_title:c.seo_title,seo_description:c.seo_description,seo_keywords:c.seo_keywords,metadata:c.metadata},f=await j.updateProduct(x,"current-user");f.success?b.success("Ürün başarıyla güncellendi"):b.error(f.error||"Ürün güncellenirken hata oluştu")}else{const x=await j.createProduct(c,"current-user");x.success?b.success("Ürün başarıyla oluşturuldu"):b.error(x.error||"Ürün oluşturulurken hata oluştu")}s(),e()}catch(x){console.error("Product save error:",x),b.error("Ürün kaydedilirken hata oluştu")}finally{l(!1)}},h=(d,x)=>{u(f=>({...f,[d]:x}))},y=(d,x)=>{const f=x.split(",").map(_=>_.trim()).filter(_=>_);u(_=>({..._,[d]:f}))};return m?r.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:r.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 border border-white/10 rounded-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[r.jsx("div",{className:"p-6 border-b border-white/10",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h3",{className:"text-2xl font-bold text-white",children:t?"Ürün Düzenle":"Yeni Ürün"}),r.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors",children:r.jsx("i",{className:"ri-close-line text-2xl"})})]})}),r.jsxs("form",{onSubmit:k,className:"p-6 space-y-6",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"md:col-span-2",children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"Ürün Adı *"}),r.jsx("input",{type:"text",required:!0,value:c.name,onChange:d=>h("name",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors",placeholder:"Ürün adını girin"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"SKU *"}),r.jsx("input",{type:"text",required:!0,value:c.sku,onChange:d=>h("sku",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors font-mono",placeholder:"ÜRÜN-SKU-001"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"Ürün Tipi"}),r.jsxs("select",{value:c.product_type,onChange:d=>h("product_type",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-blue-400 transition-colors",children:[r.jsx("option",{value:"simple",children:"Basit"}),r.jsx("option",{value:"variable",children:"Varyantlı"}),r.jsx("option",{value:"grouped",children:"Gruplu"}),r.jsx("option",{value:"external",children:"Harici"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"Durum"}),r.jsxs("select",{value:c.status,onChange:d=>h("status",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-blue-400 transition-colors",children:[r.jsx("option",{value:"draft",children:"Taslak"}),r.jsx("option",{value:"active",children:"Aktif"}),r.jsx("option",{value:"inactive",children:"Pasif"}),r.jsx("option",{value:"archived",children:"Arşiv"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"Ağırlık (kg)"}),r.jsx("input",{type:"number",step:"0.01",min:"0",value:c.weight||"",onChange:d=>h("weight",d.target.value?parseFloat(d.target.value):void 0),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors",placeholder:"0.5"})]})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"Kısa Açıklama *"}),r.jsx("textarea",{required:!0,value:c.short_description,onChange:d=>h("short_description",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors",placeholder:"Ürünün kısa açıklaması...",rows:2})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"Detaylı Açıklama *"}),r.jsx("textarea",{required:!0,value:c.description,onChange:d=>h("description",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors",placeholder:"Ürünün detaylı açıklaması...",rows:4})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"Kategoriler"}),r.jsx("input",{type:"text",value:c.categories.join(", "),onChange:d=>y("categories",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors",placeholder:"Elektronik, Telefon, Aksesuar"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"Etiketler"}),r.jsx("input",{type:"text",value:c.tags.join(", "),onChange:d=>y("tags",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors",placeholder:"popüler, indirim, yeni"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"SEO Başlığı"}),r.jsx("input",{type:"text",value:c.seo_title,onChange:d=>h("seo_title",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors",placeholder:"SEO için başlık..."})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"SEO Açıklaması"}),r.jsx("textarea",{value:c.seo_description,onChange:d=>h("seo_description",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors",placeholder:"SEO için açıklama...",rows:2})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-white font-medium mb-2",children:"SEO Anahtar Kelimeler"}),r.jsx("input",{type:"text",value:c.seo_keywords.join(", "),onChange:d=>y("seo_keywords",d.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors",placeholder:"telefon, akıllı telefon, iphone"})]}),r.jsxs("div",{className:"flex space-x-4 pt-4",children:[r.jsx("button",{type:"button",onClick:e,className:"flex-1 bg-white/10 hover:bg-white/20 border border-white/20 text-white px-6 py-3 rounded-xl font-medium transition-all duration-300",children:"İptal"}),r.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 disabled:opacity-50 disabled:cursor-not-allowed text-white px-6 py-3 rounded-xl font-medium transition-all duration-300",children:i?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),t?"Güncelleniyor...":"Oluşturuluyor..."]}):t?"Güncelle":"Oluştur"})]})]})]})}):null}function Z(){const{userProfile:m}=K(),[e,s]=g.useState([]),[t,a]=g.useState(!0),[i,l]=g.useState(""),[n,c]=g.useState("all"),[u,k]=g.useState("all"),[h,y]=g.useState([]),[d,x]=g.useState(!1),[f,_]=g.useState(null),[v,N]=g.useState(1),[S,D]=g.useState(1),P=async()=>{const o=m?.role==="super_admin"?void 0:m?.tenant_id;if(!o&&m?.role!=="super_admin"){console.log("No tenant_id found for user:",m);return}try{a(!0);const w=await j.getProducts({tenant_id:o||"all",filters:{status:n==="all"?void 0:n,product_type:u==="all"?void 0:u,search:i||void 0},pagination:{page:v,limit:20}});w.success&&w.products?(s(w.products.data),D(w.products.totalPages)):b.error("Ürünler yüklenirken hata oluştu")}catch(w){console.error("Product yükleme hatası:",w),b.error("Ürünler yüklenirken hata oluştu")}finally{a(!1)}};g.useEffect(()=>{P()},[m?.tenant_id,i,n,u,v]);const C=e.filter(o=>{const w=o.name.toLowerCase().includes(i.toLowerCase())||o.sku.toLowerCase().includes(i.toLowerCase())||o.description.toLowerCase().includes(i.toLowerCase()),U=n==="all"||o.status===n,G=u==="all"||o.product_type===u;return w&&U&&G}),I=o=>{switch(o){case"active":return"bg-green-500/20 text-green-400";case"inactive":return"bg-gray-500/20 text-gray-400";case"draft":return"bg-yellow-500/20 text-yellow-400";case"archived":return"bg-red-500/20 text-red-400";default:return"bg-gray-500/20 text-gray-400"}},T=o=>{switch(o){case"active":return"Aktif";case"inactive":return"Pasif";case"draft":return"Taslak";case"archived":return"Arşiv";default:return"Bilinmiyor"}},B=o=>{switch(o){case"simple":return"bg-blue-500/20 text-blue-400";case"variable":return"bg-purple-500/20 text-purple-400";case"grouped":return"bg-orange-500/20 text-orange-400";case"external":return"bg-pink-500/20 text-pink-400";default:return"bg-gray-500/20 text-gray-400"}},A=o=>{switch(o){case"simple":return"Basit";case"variable":return"Varyantlı";case"grouped":return"Gruplu";case"external":return"Harici";default:return"Bilinmiyor"}},M=o=>{y(w=>w.includes(o)?w.filter(U=>U!==o):[...w,o])},E=async o=>{try{await j.bulkUpdateStatus(h,o),b.success(`${h.length} ürün durumu güncellendi`),y([]),P()}catch(w){console.error("Toplu durum güncelleme hatası:",w),b.error("Durum güncellenirken hata oluştu")}},O=async o=>{if(confirm("Bu ürünü silmek istediğinizden emin misiniz?"))try{await j.deleteProduct({id:o},m?.id||""),b.success("Ürün başarıyla silindi"),P()}catch(w){console.error("Product silme hatası:",w),b.error("Ürün silinirken hata oluştu")}};return t?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 flex items-center justify-center",children:r.jsxs("div",{className:"text-center",children:[r.jsx("div",{className:"w-16 h-16 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),r.jsx("p",{className:"text-white text-lg",children:"Ürünler yükleniyor..."})]})}):r.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:[r.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[r.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-500/20 rounded-full blur-3xl animate-pulse"}),r.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500/20 rounded-full blur-3xl animate-pulse delay-1000"}),r.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-cyan-500/10 rounded-full blur-3xl animate-pulse delay-2000"})]}),r.jsx("div",{className:"relative z-10",children:r.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r.jsx("div",{className:"bg-gradient-to-r from-blue-600/20 to-purple-600/20 backdrop-blur-sm border border-white/10 rounded-2xl p-6 mb-8",children:r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Ürün Yönetimi"}),r.jsx("p",{className:"text-gray-300",children:"Ürünlerinizi görüntüleyin ve yönetin"})]}),r.jsxs("button",{onClick:()=>x(!0),className:"bg-gradient-to-r from-blue-500 to-purple-500 hover:from-blue-600 hover:to-purple-600 text-white px-6 py-3 rounded-xl font-medium transition-all duration-300 cursor-pointer",children:[r.jsx("i",{className:"ri-add-line mr-2"}),"Yeni Ürün"]})]})}),r.jsx("div",{className:"bg-black/20 backdrop-blur-sm border border-white/10 rounded-2xl p-6 mb-8",children:r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsx("div",{className:"flex-1",children:r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"text",placeholder:"Ürün ara...",value:i,onChange:o=>l(o.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 pl-12 text-white placeholder-gray-400 focus:outline-none focus:border-blue-400 transition-colors"}),r.jsx("i",{className:"ri-search-line absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400"})]})}),r.jsx("div",{className:"md:w-48",children:r.jsxs("select",{value:n,onChange:o=>c(o.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-blue-400 transition-colors pr-8",children:[r.jsx("option",{value:"all",children:"Tüm Durumlar"}),r.jsx("option",{value:"active",children:"Aktif"}),r.jsx("option",{value:"inactive",children:"Pasif"}),r.jsx("option",{value:"draft",children:"Taslak"}),r.jsx("option",{value:"archived",children:"Arşiv"})]})}),r.jsx("div",{className:"md:w-48",children:r.jsxs("select",{value:u,onChange:o=>k(o.target.value),className:"w-full bg-white/10 border border-white/20 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-blue-400 transition-colors pr-8",children:[r.jsx("option",{value:"all",children:"Tüm Tipler"}),r.jsx("option",{value:"simple",children:"Basit"}),r.jsx("option",{value:"variable",children:"Varyantlı"}),r.jsx("option",{value:"grouped",children:"Gruplu"}),r.jsx("option",{value:"external",children:"Harici"})]})}),h.length>0&&r.jsxs("div",{className:"flex space-x-2",children:[r.jsxs("button",{onClick:()=>E("active"),className:"bg-green-500/20 hover:bg-green-500/30 border border-green-500/50 text-green-400 px-4 py-3 rounded-xl transition-colors cursor-pointer",children:[r.jsx("i",{className:"ri-check-line mr-2"}),"Aktifleştir"]}),r.jsxs("button",{onClick:()=>E("inactive"),className:"bg-gray-500/20 hover:bg-gray-500/30 border border-gray-500/50 text-gray-400 px-4 py-3 rounded-xl transition-colors cursor-pointer",children:[r.jsx("i",{className:"ri-pause-line mr-2"}),"Pasifleştir"]}),r.jsxs("button",{onClick:()=>E("archived"),className:"bg-red-500/20 hover:bg-red-500/30 border border-red-500/50 text-red-400 px-4 py-3 rounded-xl transition-colors cursor-pointer",children:[r.jsx("i",{className:"ri-archive-line mr-2"}),"Arşivle"]})]})]})}),r.jsxs("div",{className:"bg-black/20 backdrop-blur-sm border border-white/10 rounded-2xl overflow-hidden",children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"w-full",children:[r.jsx("thead",{className:"bg-white/5 border-b border-white/10",children:r.jsxs("tr",{children:[r.jsx("th",{className:"text-left p-4",children:r.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500",onChange:o=>{o.target.checked?y(C.map(w=>w.id)):y([])}})}),r.jsx("th",{className:"text-left p-4 text-gray-300 font-medium",children:"Ürün"}),r.jsx("th",{className:"text-left p-4 text-gray-300 font-medium",children:"SKU"}),r.jsx("th",{className:"text-left p-4 text-gray-300 font-medium",children:"Tip"}),r.jsx("th",{className:"text-left p-4 text-gray-300 font-medium",children:"Durum"}),r.jsx("th",{className:"text-left p-4 text-gray-300 font-medium",children:"Stok"}),r.jsx("th",{className:"text-left p-4 text-gray-300 font-medium",children:"Fiyat"}),r.jsx("th",{className:"text-left p-4 text-gray-300 font-medium",children:"Oluşturulma"}),r.jsx("th",{className:"text-left p-4 text-gray-300 font-medium",children:"İşlemler"})]})}),r.jsx("tbody",{children:C.map(o=>r.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors",children:[r.jsx("td",{className:"p-4",children:r.jsx("input",{type:"checkbox",checked:h.includes(o.id),onChange:()=>M(o.id),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500"})}),r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex items-center space-x-3",children:[r.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-gray-700 flex items-center justify-center",children:o.getPrimaryImageUrl()?r.jsx("img",{src:o.getPrimaryImageUrl()||"",alt:o.name,className:"w-full h-full object-cover"}):r.jsx("i",{className:"ri-image-line text-gray-400 text-xl"})}),r.jsxs("div",{children:[r.jsx("div",{className:"text-white font-medium",children:o.name}),r.jsx("div",{className:"text-gray-400 text-sm line-clamp-1",children:o.short_description})]})]})}),r.jsx("td",{className:"p-4 text-gray-300 font-mono text-sm",children:o.sku}),r.jsx("td",{className:"p-4",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${B(o.product_type)}`,children:A(o.product_type)})}),r.jsx("td",{className:"p-4",children:r.jsx("span",{className:`px-2 py-1 rounded-full text-sm ${I(o.status)}`,children:T(o.status)})}),r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"text-gray-300",children:[o.getTotalStock(),o.getTotalStock()<=10&&r.jsx("span",{className:"text-red-400 text-xs ml-1",children:"(Düşük)"})]})}),r.jsx("td",{className:"p-4 text-gray-300",children:o.getMinPrice()&&o.getMaxPrice()?o.getMinPrice()===o.getMaxPrice()?`₺${o.getMinPrice()}`:`₺${o.getMinPrice()} - ₺${o.getMaxPrice()}`:"-"}),r.jsx("td",{className:"p-4 text-gray-400 text-sm",children:new Date(o.created_at).toLocaleDateString("tr-TR")}),r.jsx("td",{className:"p-4",children:r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>_(o),className:"text-blue-400 hover:text-blue-300 transition-colors cursor-pointer",title:"Düzenle",children:r.jsx("i",{className:"ri-edit-line"})}),r.jsx("button",{onClick:()=>O(o.id),className:"text-red-400 hover:text-red-300 transition-colors cursor-pointer",title:"Sil",children:r.jsx("i",{className:"ri-delete-bin-line"})})]})})]},o.id))})]})}),r.jsxs("div",{className:"p-4 border-t border-white/10 flex items-center justify-between",children:[r.jsxs("div",{className:"text-gray-400 text-sm",children:[C.length," ürün gösteriliyor"]}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsx("button",{onClick:()=>N(Math.max(1,v-1)),disabled:v===1,className:"bg-white/10 hover:bg-white/20 disabled:opacity-50 disabled:cursor-not-allowed text-gray-300 px-3 py-2 rounded-lg transition-colors cursor-pointer",children:r.jsx("i",{className:"ri-arrow-left-line"})}),r.jsx("span",{className:"bg-blue-500 text-white px-3 py-2 rounded-lg",children:v}),r.jsx("button",{onClick:()=>N(Math.min(S,v+1)),disabled:v===S,className:"bg-white/10 hover:bg-white/20 disabled:opacity-50 disabled:cursor-not-allowed text-gray-300 px-3 py-2 rounded-lg transition-colors cursor-pointer",children:r.jsx("i",{className:"ri-arrow-right-line"})})]})]})]})]})}),r.jsx(Y,{isOpen:d||!!f,onClose:()=>{x(!1),_(null)},onSuccess:()=>{P()},editingProduct:f,tenantId:m?.tenant_id||void 0})]})}export{Z as default};
//# sourceMappingURL=page-BxELV8sR.js.map
